8672f6e706355ca49e19ed205080c76d
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _Platform = _interopRequireDefault(require("../Utilities/Platform"));

var _RCTDeviceEventEmitter = _interopRequireDefault(require("./RCTDeviceEventEmitter"));

var _invariant = _interopRequireDefault(require("invariant"));

var NativeEventEmitter = function () {
  function NativeEventEmitter(nativeModule) {
    (0, _classCallCheck2.default)(this, NativeEventEmitter);

    if (_Platform.default.OS === 'ios') {
      (0, _invariant.default)(nativeModule != null, '`new NativeEventEmitter()` requires a non-null argument.');
    }

    var hasAddListener = !!nativeModule && typeof nativeModule.addListener === 'function';
    var hasRemoveListeners = !!nativeModule && typeof nativeModule.removeListeners === 'function';

    if (nativeModule && hasAddListener && hasRemoveListeners) {
      this._nativeModule = nativeModule;
    } else if (nativeModule != null) {
      if (!hasAddListener) {
        console.warn('`new NativeEventEmitter()` was called with a non-null argument without the required `addListener` method.');
      }

      if (!hasRemoveListeners) {
        console.warn('`new NativeEventEmitter()` was called with a non-null argument without the required `removeListeners` method.');
      }
    }
  }

  (0, _createClass2.default)(NativeEventEmitter, [{
    key: "addListener",
    value: function addListener(eventType, listener, context) {
      var _this$_nativeModule,
          _this = this;

      (_this$_nativeModule = this._nativeModule) == null ? void 0 : _this$_nativeModule.addListener(eventType);

      var subscription = _RCTDeviceEventEmitter.default.addListener(eventType, listener, context);

      return {
        remove: function remove() {
          if (subscription != null) {
            var _this$_nativeModule2;

            (_this$_nativeModule2 = _this._nativeModule) == null ? void 0 : _this$_nativeModule2.removeListeners(1);
            subscription.remove();
            subscription = null;
          }
        }
      };
    }
  }, {
    key: "removeListener",
    value: function removeListener(eventType, listener) {
      var _this$_nativeModule3;

      (_this$_nativeModule3 = this._nativeModule) == null ? void 0 : _this$_nativeModule3.removeListeners(1);

      _RCTDeviceEventEmitter.default.removeListener(eventType, listener);
    }
  }, {
    key: "emit",
    value: function emit(eventType) {
      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }

      _RCTDeviceEventEmitter.default.emit.apply(_RCTDeviceEventEmitter.default, [eventType].concat(args));
    }
  }, {
    key: "removeAllListeners",
    value: function removeAllListeners(eventType) {
      var _this$_nativeModule4;

      (0, _invariant.default)(eventType != null, '`NativeEventEmitter.removeAllListener()` requires a non-null argument.');
      (_this$_nativeModule4 = this._nativeModule) == null ? void 0 : _this$_nativeModule4.removeListeners(this.listenerCount(eventType));

      _RCTDeviceEventEmitter.default.removeAllListeners(eventType);
    }
  }, {
    key: "listenerCount",
    value: function listenerCount(eventType) {
      return _RCTDeviceEventEmitter.default.listenerCount(eventType);
    }
  }]);
  return NativeEventEmitter;
}();

exports.default = NativeEventEmitter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOYXRpdmVFdmVudEVtaXR0ZXIiLCJuYXRpdmVNb2R1bGUiLCJQbGF0Zm9ybSIsIk9TIiwiaW52YXJpYW50IiwiaGFzQWRkTGlzdGVuZXIiLCJhZGRMaXN0ZW5lciIsImhhc1JlbW92ZUxpc3RlbmVycyIsInJlbW92ZUxpc3RlbmVycyIsIl9uYXRpdmVNb2R1bGUiLCJjb25zb2xlIiwid2FybiIsImV2ZW50VHlwZSIsImxpc3RlbmVyIiwiY29udGV4dCIsInN1YnNjcmlwdGlvbiIsIlJDVERldmljZUV2ZW50RW1pdHRlciIsInJlbW92ZSIsInJlbW92ZUxpc3RlbmVyIiwiYXJncyIsImVtaXQiLCJsaXN0ZW5lckNvdW50IiwicmVtb3ZlQWxsTGlzdGVuZXJzIl0sInNvdXJjZXMiOlsiTmF0aXZlRXZlbnRFbWl0dGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB7XG4gIHR5cGUgRXZlbnRTdWJzY3JpcHRpb24sXG4gIHR5cGUgSUV2ZW50RW1pdHRlcixcbn0gZnJvbSAnLi4vdmVuZG9yL2VtaXR0ZXIvRXZlbnRFbWl0dGVyJztcbmltcG9ydCBQbGF0Zm9ybSBmcm9tICcuLi9VdGlsaXRpZXMvUGxhdGZvcm0nO1xuaW1wb3J0IFJDVERldmljZUV2ZW50RW1pdHRlciBmcm9tICcuL1JDVERldmljZUV2ZW50RW1pdHRlcic7XG5pbXBvcnQgaW52YXJpYW50IGZyb20gJ2ludmFyaWFudCc7XG5cbmludGVyZmFjZSBOYXRpdmVNb2R1bGUge1xuICBhZGRMaXN0ZW5lcihldmVudFR5cGU6IHN0cmluZyk6IHZvaWQ7XG4gIHJlbW92ZUxpc3RlbmVycyhjb3VudDogbnVtYmVyKTogdm9pZDtcbn1cblxuZXhwb3J0IHR5cGUge0V2ZW50U3Vic2NyaXB0aW9ufTtcblxuLyoqXG4gKiBgTmF0aXZlRXZlbnRFbWl0dGVyYCBpcyBpbnRlbmRlZCBmb3IgdXNlIGJ5IE5hdGl2ZSBNb2R1bGVzIHRvIGVtaXQgZXZlbnRzIHRvXG4gKiBKYXZhU2NyaXB0IGxpc3RlbmVycy4gSWYgYSBgTmF0aXZlTW9kdWxlYCBpcyBzdXBwbGllZCB0byB0aGUgY29uc3RydWN0b3IsIGl0XG4gKiB3aWxsIGJlIG5vdGlmaWVkICh2aWEgYGFkZExpc3RlbmVyYCBhbmQgYHJlbW92ZUxpc3RlbmVyc2ApIHdoZW4gdGhlIGxpc3RlbmVyXG4gKiBjb3VudCBjaGFuZ2VzIHRvIG1hbmFnZSBcIm5hdGl2ZSBtZW1vcnlcIi5cbiAqXG4gKiBDdXJyZW50bHksIGFsbCBuYXRpdmUgZXZlbnRzIGFyZSBmaXJlZCB2aWEgYSBnbG9iYWwgYFJDVERldmljZUV2ZW50RW1pdHRlcmAuXG4gKiBUaGlzIG1lYW5zIGV2ZW50IG5hbWVzIG11c3QgYmUgZ2xvYmFsbHkgdW5pcXVlLCBhbmQgaXQgbWVhbnMgdGhhdCBjYWxsIHNpdGVzXG4gKiBjYW4gdGhlb3JldGljYWxseSBsaXN0ZW4gdG8gYFJDVERldmljZUV2ZW50RW1pdHRlcmAgKGFsdGhvdWdoIGRpc2NvdXJhZ2VkKS5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTmF0aXZlRXZlbnRFbWl0dGVyPFRFdmVudFRvQXJnc01hcDogey4uLn0+XG4gIGltcGxlbWVudHMgSUV2ZW50RW1pdHRlcjxURXZlbnRUb0FyZ3NNYXA+XG57XG4gIF9uYXRpdmVNb2R1bGU6ID9OYXRpdmVNb2R1bGU7XG5cbiAgY29uc3RydWN0b3IobmF0aXZlTW9kdWxlOiA/TmF0aXZlTW9kdWxlKSB7XG4gICAgaWYgKFBsYXRmb3JtLk9TID09PSAnaW9zJykge1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICBuYXRpdmVNb2R1bGUgIT0gbnVsbCxcbiAgICAgICAgJ2BuZXcgTmF0aXZlRXZlbnRFbWl0dGVyKClgIHJlcXVpcmVzIGEgbm9uLW51bGwgYXJndW1lbnQuJyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgaGFzQWRkTGlzdGVuZXIgPVxuICAgICAgLy8gJEZsb3dGaXhNZVttZXRob2QtdW5iaW5kaW5nXSBhZGRlZCB3aGVuIGltcHJvdmluZyB0eXBpbmcgZm9yIHRoaXMgcGFyYW1ldGVyc1xuICAgICAgISFuYXRpdmVNb2R1bGUgJiYgdHlwZW9mIG5hdGl2ZU1vZHVsZS5hZGRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJztcbiAgICBjb25zdCBoYXNSZW1vdmVMaXN0ZW5lcnMgPVxuICAgICAgLy8gJEZsb3dGaXhNZVttZXRob2QtdW5iaW5kaW5nXSBhZGRlZCB3aGVuIGltcHJvdmluZyB0eXBpbmcgZm9yIHRoaXMgcGFyYW1ldGVyc1xuICAgICAgISFuYXRpdmVNb2R1bGUgJiYgdHlwZW9mIG5hdGl2ZU1vZHVsZS5yZW1vdmVMaXN0ZW5lcnMgPT09ICdmdW5jdGlvbic7XG5cbiAgICBpZiAobmF0aXZlTW9kdWxlICYmIGhhc0FkZExpc3RlbmVyICYmIGhhc1JlbW92ZUxpc3RlbmVycykge1xuICAgICAgdGhpcy5fbmF0aXZlTW9kdWxlID0gbmF0aXZlTW9kdWxlO1xuICAgIH0gZWxzZSBpZiAobmF0aXZlTW9kdWxlICE9IG51bGwpIHtcbiAgICAgIGlmICghaGFzQWRkTGlzdGVuZXIpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICdgbmV3IE5hdGl2ZUV2ZW50RW1pdHRlcigpYCB3YXMgY2FsbGVkIHdpdGggYSBub24tbnVsbCBhcmd1bWVudCB3aXRob3V0IHRoZSByZXF1aXJlZCBgYWRkTGlzdGVuZXJgIG1ldGhvZC4nLFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgaWYgKCFoYXNSZW1vdmVMaXN0ZW5lcnMpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICdgbmV3IE5hdGl2ZUV2ZW50RW1pdHRlcigpYCB3YXMgY2FsbGVkIHdpdGggYSBub24tbnVsbCBhcmd1bWVudCB3aXRob3V0IHRoZSByZXF1aXJlZCBgcmVtb3ZlTGlzdGVuZXJzYCBtZXRob2QuJyxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhZGRMaXN0ZW5lcjxURXZlbnQ6ICRLZXlzPFRFdmVudFRvQXJnc01hcD4+KFxuICAgIGV2ZW50VHlwZTogVEV2ZW50LFxuICAgIGxpc3RlbmVyOiAoLi4uYXJnczogJEVsZW1lbnRUeXBlPFRFdmVudFRvQXJnc01hcCwgVEV2ZW50PikgPT4gbWl4ZWQsXG4gICAgY29udGV4dD86IG1peGVkLFxuICApOiBFdmVudFN1YnNjcmlwdGlvbiB7XG4gICAgdGhpcy5fbmF0aXZlTW9kdWxlPy5hZGRMaXN0ZW5lcihldmVudFR5cGUpO1xuICAgIGxldCBzdWJzY3JpcHRpb246ID9FdmVudFN1YnNjcmlwdGlvbiA9IFJDVERldmljZUV2ZW50RW1pdHRlci5hZGRMaXN0ZW5lcihcbiAgICAgIGV2ZW50VHlwZSxcbiAgICAgIGxpc3RlbmVyLFxuICAgICAgY29udGV4dCxcbiAgICApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlbW92ZTogKCkgPT4ge1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9uICE9IG51bGwpIHtcbiAgICAgICAgICB0aGlzLl9uYXRpdmVNb2R1bGU/LnJlbW92ZUxpc3RlbmVycygxKTtcbiAgICAgICAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS11c2VdXG4gICAgICAgICAgc3Vic2NyaXB0aW9uLnJlbW92ZSgpO1xuICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCBVc2UgYHJlbW92ZWAgb24gdGhlIEV2ZW50U3Vic2NyaXB0aW9uIGZyb20gYGFkZExpc3RlbmVyYC5cbiAgICovXG4gIHJlbW92ZUxpc3RlbmVyPFRFdmVudDogJEtleXM8VEV2ZW50VG9BcmdzTWFwPj4oXG4gICAgZXZlbnRUeXBlOiBURXZlbnQsXG4gICAgbGlzdGVuZXI6ICguLi5hcmdzOiAkRWxlbWVudFR5cGU8VEV2ZW50VG9BcmdzTWFwLCBURXZlbnQ+KSA9PiBtaXhlZCxcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5fbmF0aXZlTW9kdWxlPy5yZW1vdmVMaXN0ZW5lcnMoMSk7XG4gICAgLy8gTk9URTogVGhpcyB3aWxsIHJlcG9ydCBhIGRlcHJlY2F0aW9uIG5vdGljZSB2aWEgYGNvbnNvbGUuZXJyb3JgLlxuICAgIC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXSAtIGByZW1vdmVMaXN0ZW5lcmAgZXhpc3RzIGJ1dCBpcyBkZXByZWNhdGVkLlxuICAgIFJDVERldmljZUV2ZW50RW1pdHRlci5yZW1vdmVMaXN0ZW5lcihldmVudFR5cGUsIGxpc3RlbmVyKTtcbiAgfVxuXG4gIGVtaXQ8VEV2ZW50OiAkS2V5czxURXZlbnRUb0FyZ3NNYXA+PihcbiAgICBldmVudFR5cGU6IFRFdmVudCxcbiAgICAuLi5hcmdzOiAkRWxlbWVudFR5cGU8VEV2ZW50VG9BcmdzTWFwLCBURXZlbnQ+XG4gICk6IHZvaWQge1xuICAgIC8vIEdlbmVyYWxseSwgYFJDVERldmljZUV2ZW50RW1pdHRlcmAgaXMgZGlyZWN0bHkgaW52b2tlZC4gQnV0IHRoaXMgaXNcbiAgICAvLyBpbmNsdWRlZCBmb3IgY29tcGxldGVuZXNzLlxuICAgIFJDVERldmljZUV2ZW50RW1pdHRlci5lbWl0KGV2ZW50VHlwZSwgLi4uYXJncyk7XG4gIH1cblxuICByZW1vdmVBbGxMaXN0ZW5lcnM8VEV2ZW50OiAkS2V5czxURXZlbnRUb0FyZ3NNYXA+PihcbiAgICBldmVudFR5cGU/OiA/VEV2ZW50LFxuICApOiB2b2lkIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBldmVudFR5cGUgIT0gbnVsbCxcbiAgICAgICdgTmF0aXZlRXZlbnRFbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVyKClgIHJlcXVpcmVzIGEgbm9uLW51bGwgYXJndW1lbnQuJyxcbiAgICApO1xuICAgIHRoaXMuX25hdGl2ZU1vZHVsZT8ucmVtb3ZlTGlzdGVuZXJzKHRoaXMubGlzdGVuZXJDb3VudChldmVudFR5cGUpKTtcbiAgICBSQ1REZXZpY2VFdmVudEVtaXR0ZXIucmVtb3ZlQWxsTGlzdGVuZXJzKGV2ZW50VHlwZSk7XG4gIH1cblxuICBsaXN0ZW5lckNvdW50PFRFdmVudDogJEtleXM8VEV2ZW50VG9BcmdzTWFwPj4oZXZlbnRUeXBlOiBURXZlbnQpOiBudW1iZXIge1xuICAgIHJldHVybiBSQ1REZXZpY2VFdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudChldmVudFR5cGUpO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiJBQVVBOzs7Ozs7Ozs7Ozs7O0FBTUE7O0FBQ0E7O0FBQ0E7O0lBbUJxQkEsa0I7RUFLbkIsNEJBQVlDLFlBQVosRUFBeUM7SUFBQTs7SUFDdkMsSUFBSUMsaUJBQUEsQ0FBU0MsRUFBVCxLQUFnQixLQUFwQixFQUEyQjtNQUN6QixJQUFBQyxrQkFBQSxFQUNFSCxZQUFZLElBQUksSUFEbEIsRUFFRSwwREFGRjtJQUlEOztJQUVELElBQU1JLGNBQWMsR0FFbEIsQ0FBQyxDQUFDSixZQUFGLElBQWtCLE9BQU9BLFlBQVksQ0FBQ0ssV0FBcEIsS0FBb0MsVUFGeEQ7SUFHQSxJQUFNQyxrQkFBa0IsR0FFdEIsQ0FBQyxDQUFDTixZQUFGLElBQWtCLE9BQU9BLFlBQVksQ0FBQ08sZUFBcEIsS0FBd0MsVUFGNUQ7O0lBSUEsSUFBSVAsWUFBWSxJQUFJSSxjQUFoQixJQUFrQ0Usa0JBQXRDLEVBQTBEO01BQ3hELEtBQUtFLGFBQUwsR0FBcUJSLFlBQXJCO0lBQ0QsQ0FGRCxNQUVPLElBQUlBLFlBQVksSUFBSSxJQUFwQixFQUEwQjtNQUMvQixJQUFJLENBQUNJLGNBQUwsRUFBcUI7UUFDbkJLLE9BQU8sQ0FBQ0MsSUFBUixDQUNFLDJHQURGO01BR0Q7O01BQ0QsSUFBSSxDQUFDSixrQkFBTCxFQUF5QjtRQUN2QkcsT0FBTyxDQUFDQyxJQUFSLENBQ0UsK0dBREY7TUFHRDtJQUNGO0VBQ0Y7Ozs7V0FFRCxxQkFDRUMsU0FERixFQUVFQyxRQUZGLEVBR0VDLE9BSEYsRUFJcUI7TUFBQTtNQUFBOztNQUNuQiw0QkFBS0wsYUFBTCx5Q0FBb0JILFdBQXBCLENBQWdDTSxTQUFoQzs7TUFDQSxJQUFJRyxZQUFnQyxHQUFHQyw4QkFBQSxDQUFzQlYsV0FBdEIsQ0FDckNNLFNBRHFDLEVBRXJDQyxRQUZxQyxFQUdyQ0MsT0FIcUMsQ0FBdkM7O01BTUEsT0FBTztRQUNMRyxNQUFNLEVBQUUsa0JBQU07VUFDWixJQUFJRixZQUFZLElBQUksSUFBcEIsRUFBMEI7WUFBQTs7WUFDeEIsNkJBQUksQ0FBQ04sYUFBTCwwQ0FBb0JELGVBQXBCLENBQW9DLENBQXBDO1lBRUFPLFlBQVksQ0FBQ0UsTUFBYjtZQUNBRixZQUFZLEdBQUcsSUFBZjtVQUNEO1FBQ0Y7TUFSSSxDQUFQO0lBVUQ7OztXQUtELHdCQUNFSCxTQURGLEVBRUVDLFFBRkYsRUFHUTtNQUFBOztNQUNOLDZCQUFLSixhQUFMLDBDQUFvQkQsZUFBcEIsQ0FBb0MsQ0FBcEM7O01BR0FRLDhCQUFBLENBQXNCRSxjQUF0QixDQUFxQ04sU0FBckMsRUFBZ0RDLFFBQWhEO0lBQ0Q7OztXQUVELGNBQ0VELFNBREYsRUFHUTtNQUFBLGtDQURITyxJQUNHO1FBREhBLElBQ0c7TUFBQTs7TUFHTkgsOEJBQUEsQ0FBc0JJLElBQXRCLE9BQUFKLDhCQUFBLEdBQTJCSixTQUEzQixTQUF5Q08sSUFBekM7SUFDRDs7O1dBRUQsNEJBQ0VQLFNBREYsRUFFUTtNQUFBOztNQUNOLElBQUFSLGtCQUFBLEVBQ0VRLFNBQVMsSUFBSSxJQURmLEVBRUUsd0VBRkY7TUFJQSw2QkFBS0gsYUFBTCwwQ0FBb0JELGVBQXBCLENBQW9DLEtBQUthLGFBQUwsQ0FBbUJULFNBQW5CLENBQXBDOztNQUNBSSw4QkFBQSxDQUFzQk0sa0JBQXRCLENBQXlDVixTQUF6QztJQUNEOzs7V0FFRCx1QkFBOENBLFNBQTlDLEVBQXlFO01BQ3ZFLE9BQU9JLDhCQUFBLENBQXNCSyxhQUF0QixDQUFvQ1QsU0FBcEMsQ0FBUDtJQUNEIn0=